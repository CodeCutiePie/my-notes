<h2>Categories List</h2>
{% assign all_categories = "" %}

{% for post in site.posts %}
    {% for category in post.categories %}
        {% unless all_categories contains category %}
            {% assign all_categories = all_categories | append: category | append: "," %}
        {% endunless %}
    {% endfor %}
{% endfor %}

{% assign categories_array = all_categories | split: "," | uniq %}

{% for category in categories_array %}
    <details>
        <summary>{{ category }}</summary>
        <ul>
            {% assign posts_in_category = site.posts | where: "categories", category %}
            {% for post in posts_in_category %}
                <li><a href="{{ post.url }}">{{ post.title }}</a></li>
            {% endfor %}
        </ul>
    </details>
{% endfor %} 